<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>salary history</title>
  <style>
    body { font-family: Arial;  padding: 20px; }
    table, th, td { border: 1px solid #aaa; border-collapse: collapse; padding: 8px; }
    table { width: 45%; margin-top: 20px; }
    th { background-color: #f0f0f0; }
    #status { margin-top: 10px; font-weight: bold; color: #444; }
    #show_pay_list_month{
  display: flex;
  flex-direction: column;
  padding: 20px;
  position: fixed;
  top: 10px;
  left: 52%;
  width: 45%;
  height: 5%;
  background-color: rgb(248, 208, 208);
  overflow: hidden;
  z-index: 1000;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
  border-radius: 10px;
  font-family: sans-serif;
    }
    #divPiy {
  display: flex;
  flex-direction: column;
  padding: 20px;
  position: fixed;
  top: 15%;
  left: 52%;
  width: 45%;
  height: 75%;
  background-color: rgb(208, 237, 248);
  overflow: hidden;
  z-index: 1000;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
  border-radius: 10px;
  font-family: sans-serif;
}

#divPiy label {
  margin-bottom: 5px;
  font-weight: bold;
}

#divPiy input,
#divPiy select {
  width: 50%;
  padding: 8px;
  margin-bottom: 15px;
  border: 1px solid #ccc;
  border-radius: 5px;
  box-sizing: border-box;
  font-size: 14px;
}

#notes {
  flex-grow: 1; /* Ÿäÿ¨ÿπŸÑ textarea Ÿäÿ£ÿÆÿ∞ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑŸÖÿ™ÿ®ŸÇŸäÿ© */
  resize: none;
  width: 100%;
  padding: 10px;
  font-size: 14px;
  border: 1px solid #ccc;
  border-radius: 5px;
  margin-bottom: 15px;
  box-sizing: border-box;
  min-height: 100px;
}

#divPiy button {
  width: 100%;
  padding: 10px;
  background-color: #3498db;
  color: white;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

#divPiy button:hover {
  background-color: #2980b9;
}

.form-row {
  display: flex;
  align-items: center;
  margin-bottom: 15px;
}

.form-row label {
  width: 100px; /* ÿπÿ±ÿ∂ ÿ´ÿßÿ®ÿ™ ŸÑŸÑŸäÿ®ŸÑ */
  margin-right: 10px;
  font-weight: bold;
}

.form-row input {
  flex: 1;
  padding: 8px;
  font-size: 14px;
  border: 1px solid #ccc;
  border-radius: 5px;
}

  </style>
</head>
<body>

<h2>–∏—Å—Ç–æ—Ä–∏—é –ø–ª–∞—Ç–µ–∂–µ–π</h2>
<p id="status">–í –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞.</p>
<p id="info_line">
  <span><strong> –§–ò–û:</strong> <span id="show_employee_name"></span></span> |
  <br>
  <span><strong> –í –û–±–µ–∫—Ç:</strong> <span id="show_projact_name"></span></span> |
  <span><strong> –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–ª–∞—Ç:</strong> <span id="show_shift"></span></span> |
  <span><strong> —Å—É–º–∞ :</strong> <span id="show_sum"></span></span> 
</p>

<table id="data-table">
  <thead>
    <tr>
      <th>—Ç–∏–ø –∑–∞—Ä–ø–ª–∞—Ç–∞</th>
      <th>–∑–∞ –º–µ—Å—è—Ü</th>
      <th>—Å—É–º–∞</th>
      <th>–±—É—Ö–≥–∞–ª—Ç–µ—Ä</th>
      <th>–æ—Ç–≤–µ—Ç—Å–≤–µ–Ω–Ω—ã–π</th>
      <th>–Ω–∞—á–∞–ª—å–Ω–∏–∫ —Å–º–µ–Ω–∞</th>
      <th>–ø—Ä–∏–º–µ—á–∞–Ω–∏—è</th>
      <th>—Å—Ç–∞—Ç—É—Å –ø–æ–ª—É—á–µ–Ω–∏—è</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>



<script>
  // ÿßÿ≥ÿ™ÿÆÿ±ÿßÿ¨ ÿßŸÑÿ®ÿßÿ±ÿßŸÖÿ™ÿ±ÿßÿ™ ŸÖŸÜ ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿµŸÅÿ≠ÿ©
  const params = new URLSearchParams(window.location.search);
  

  function loadData() {
   const empId = params.get("employee_id_input");
   const projId = params.get("project_id_input");
   
    
    if (!empId || !projId ) {
      document.getElementById('status').textContent = '‚ö†Ô∏è ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ŸÖÿπÿ±ŸÅ ÿßŸÑŸÖŸàÿ∏ŸÅ ŸàÿßŸÑŸÖÿ¥ÿ±Ÿàÿπ.';
      return;
    }

    let apiUrl = `http://127.0.0.1:8001/show_salary_history?employee_id_input=${empId}&project_id_input=${projId}`;

    
    document.getElementById('status').textContent = 'üîÑ ÿ¨ÿßÿ±Ÿç ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™...';
    document.getElementById('data-table').style.display = 'none';
    document.querySelector('#data-table tbody').innerHTML = '';

    fetch(apiUrl)
      .then(res => res.json())
      .then(data => {
        if (!data || data.length === 0) {
          document.getElementById('status').textContent = '‚ùå ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿ∑ÿßÿ®ŸÇÿ©.';
          return;
        }

        const tbody = document.querySelector('#data-table tbody');
        let total = 0;

        data.forEach(item => {
          const row = document.createElement('tr');
          const selEmp = Number(item.sum || 0);
          total += selEmp;

          row.innerHTML = `
            <td>${item.pay_method}</td>
            <td>${item.pay_for}</td>
            <td>${item.sum}</td>
            <td>${item.data_entry_clerk_id}</td>
            <td>${item.process_supervisor_id}</td>
            <td>${item.responsible_emp_id}</td>
            <td>${item.nots}</td>
            <td>${item.done_or_not}</td>
          `;
          tbody.appendChild(row);
          document.getElementById('show_employee_name').textContent = `${item.employee_name}`;
          document.getElementById('show_projact_name').textContent = `${item.projuct_title}`;
        });

        document.getElementById('data-table').style.display = 'table';
        document.getElementById('status').style.display = 'none';
        document.getElementById('show_shift').textContent = `${data.length}`;
        document.getElementById('show_sum').textContent = `${total}`;

      })
      .catch(err => {
        document.getElementById('status').textContent = '‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™.';
        console.error(err);
      });
      
  }
      window.onload = loadData;

</script>


</body>
</html>
